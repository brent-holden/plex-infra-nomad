nomad:
  datacenter: lab
  region: home

common:
  env:
    puid: 1100
    pgid: 1100

app:
  authelia:
    volumes:
      config: /opt/services/authelia
    traefik:
      hostname: auth
      path: /
      entrypoints: websecure
      middlewares: authelia@consulcatalog
      tls:
        use: true
        certresolver: letsencrypt
      forwardauth:
        address: http://authelia.service.consul:9092/api/verify?rd=https://auth.eventide.network/
        trustforwardheader: true
        authresponseheaders: Remote-User,Remote-Groups,Remote-Name,Remote-Email

  caddy:
    volumes:
      config: /opt/caddy
    traefik:
      hostname: plex-request
      path: /downloads
      entrypoints: websecure

  kavita:
    volumes:
      config: /opt/kavita
    traefik:
      hostname: kavita
      path: /
      entrypoints: websecure

  lidarr:
    volumes:
      config: /opt/services/lidarr
      downloads: /mnt/media/downloads/complete
      tv: /mnt/media/tv-shows
    traefik:
      hostname: plex-request
      path: /lidarr
      entrypoints: websecure

  grafana:
    volumes:
      config: /opt/services/grafana/config
      data: /opt/services/grafana/data
    traefik:
      hostname: plex-request
      path: /lidarr
      entrypoints: websecure

  overseerr:
    traefik:
      hostname: plex-request
      path: /
      entrypoints: websecure

  plex:
    constraints:
      operator: =
      node: nomad-3
    volumes:
      root: /mnt/media/
      config: /opt/services/plex
      transcode: /mnt/transcode

  prowlarr:
    volumes:
      config: /opt/services/prowlarr
      downloads: /mnt/rclone/media/downloads/complete
      tv: /mnt/media/tv-shows
    traefik:
      hostname: plex-request
      path: /prowlarr
      entrypoints: websecure

  radarr:
    volumes:
      config: /opt/services/radarr
      downloads: /mnt/rclone/media/downloads/complete
      tv: /mnt/rclone/media/tv-shows
    traefik:
      hostname: plex-request
      path: /radarr
      entrypoints: websecure

  readarr:
    volumes:
      config: /opt/services/readarr
      downloads: /mnt/rclone/downloads/complete
      books: /mnt/rclone/media/Books
    traefik:
      hostname: plex-request
      path: /readarr
      entrypoints: websecure

  sabnzbd:
    volumes:
      config: /opt/services/sabnzbd
      downloads:
        complete: /mnt/rclone/media/downloads/complete
        incomplete: /mnt/rclone/media/downloads/incomplete
    traefik:
      hostname: plex-request
      path: /sabnzbd
      entrypoints: websecure

  sonarr:
    volumes:
      config: /opt/services/sonarr
      downloads: /mnt/media/downloads/complete
      tv: /mnt/media/tv-shows
    traefik:
      hostname: plex-request
      path: /sonarr
      entrypoints: websecure

  traefik:
    volumes:
      dynamic: /opt/traefik/dynamic
      certificates: /mnt/traefik/certificates
    consul:
      address: 192.168.10.2
      port: 8500
    domain:
      tld: eventide.network

  tautulli:
    volumes:
      config: /opt/services/tautulli
    traefik:
      hostname: plex-request
      path: /tautulli
      entrypoints: websecure

